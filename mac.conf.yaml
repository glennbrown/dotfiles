- defaults:
    link:
      relink: true
      force: true
      create: true

- link:
    ~/.Brewfile:
      if: '[ "$(hostname -s)" = "Glenns-Laptop" ]'
      path: brewfiles/Brewfile.laptop

- link:
    ~/.Brewfile:
      if: '[ "$(hostname -s)" = "thor" ]'
      path: brewfiles/Brewfile.server

- shell:
    - description: "Run homebrew"
      command: "brew bundle"
    - description: "Configuring Dock"
      command: |
        ~/bin/dock_manager.sh
    - description: Run hostname-specific defaults
      command: |
        if [ "$(hostname -s)" = "Glenns-Laptop" ]; then
          ~/bin/macos-laptop-defaults.sh
        elif [ "$(hostname -s)" = "thor" ]; then
          ~/bin/macos-server-defaults.sh
        fi
      stdin: true
      stdout: true
      stderr: true